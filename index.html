<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- CRITICAL: Error catching BEFORE anything else loads -->
    <script>
      // Catch ALL errors including module evaluation errors
      window.__earlyErrors = [];
      window.onerror = function(msg, url, line, col, error) {
        var entry = {
          timestamp: new Date().toISOString(),
          type: 'early-module-error',
          message: String(msg),
          filename: url,
          lineno: line,
          colno: col,
          stack: error && error.stack ? error.stack : null,
          errorName: error && error.name ? error.name : null
        };
        window.__earlyErrors.push(entry);
        try {
          var existing = [];
          try { existing = JSON.parse(localStorage.getItem('client_error_logs') || '[]'); } catch(e) {}
          existing.unshift(entry);
          if (existing.length > 50) existing = existing.slice(0, 50);
          localStorage.setItem('client_error_logs', JSON.stringify(existing));
        } catch(e) {}
        console.error('[EARLY ERROR]', msg, url, line, error);
        return false;
      };
      // Also catch unhandled promise rejections (async module loading)
      window.onunhandledrejection = function(event) {
        var reason = event.reason;
        var entry = {
          timestamp: new Date().toISOString(),
          type: 'unhandled-rejection',
          message: reason && reason.message ? reason.message : String(reason),
          stack: reason && reason.stack ? reason.stack : null,
          errorName: reason && reason.name ? reason.name : null
        };
        window.__earlyErrors.push(entry);
        try {
          var existing = [];
          try { existing = JSON.parse(localStorage.getItem('client_error_logs') || '[]'); } catch(e) {}
          existing.unshift(entry);
          if (existing.length > 50) existing = existing.slice(0, 50);
          localStorage.setItem('client_error_logs', JSON.stringify(existing));
        } catch(e) {}
        console.error('[UNHANDLED REJECTION]', reason);
      };
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Buy crypto with credit card or bank transfer. Fast, secure cryptocurrency purchases with low fees." />
    <meta property="og:title" content="Card2Crypto - Buy Crypto Instantly" />
    <meta property="og:description" content="Fast, secure cryptocurrency purchases with credit card or bank transfer. Low fees, instant delivery." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og-image.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Card2Crypto - Buy Crypto Instantly" />
    <meta name="twitter:description" content="Fast, secure cryptocurrency purchases with credit card or bank transfer." />
    <link rel="canonical" href="https://card2crypto.com" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <!-- Preconnect to CDNs for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FinancialService",
      "name": "Card2Crypto",
      "description": "Fast, secure cryptocurrency purchases with credit card or bank transfer",
      "url": "https://card2crypto.com",
      "sameAs": [],
      "offers": {
        "@type": "Offer",
        "description": "Cryptocurrency purchase services"
      }
    }
    </script>
    <title>Card2Crypto - Buy Crypto with Credit Card | Fast & Secure</title>
  </head>

  <body>
    <div id="root"></div>
    <!-- Buffer polyfill MUST load before any module scripts for Particle SDK -->
    <script>
      // Pre-initialize globals that SDKs expect
      window.global = window;
      window.process = window.process || { env: {} };
      // Buffer will be properly set by the polyfills module, but we need a placeholder
      // to prevent "Buffer is not defined" during chunk loading
      if (typeof window.Buffer === 'undefined') {
        window.Buffer = {
          isBuffer: function() { return false; },
          from: function(data, encoding) {
            if (typeof data === 'string') {
              return new TextEncoder().encode(data);
            }
            return new Uint8Array(data);
          },
          alloc: function(size) { return new Uint8Array(size); },
          allocUnsafe: function(size) { return new Uint8Array(size); },
          concat: function(list) {
            var totalLength = list.reduce(function(acc, arr) { return acc + arr.length; }, 0);
            var result = new Uint8Array(totalLength);
            var offset = 0;
            for (var i = 0; i < list.length; i++) {
              result.set(list[i], offset);
              offset += list[i].length;
            }
            return result;
          }
        };
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
